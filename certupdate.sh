#!/bin/bash

# مسیر مورد نظر شما
CERTS_DIR="/var/lib/marznode/certs"

# اگر پوشه وجود نداشته باشد، آن را می‌سازد (-p یعنی اگر والد هم نبود بساز)
if [ ! -d "$CERTS_DIR" ]; then
    echo "Directory $CERTS_DIR does not exist. Creating it..."
    mkdir -p "$CERTS_DIR"
fi

echo "Writing certificate files..."

# ایجاد یا بازنویسی فایل fullchain.pem
cat > "$CERTS_DIR/fullchain.pem" << 'EOF'
-----BEGIN CERTIFICATE-----
MIIEmjCCBCCgAwIBAgISBunk/DAj1nBke55HojCm+qILMAoGCCqGSM49BAMDMDIx
CzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQswCQYDVQQDEwJF
NzAeFw0yNjAyMDEwODI3MDJaFw0yNjA1MDIwODI3MDFaMBcxFTATBgNVBAMTDGFs
bGZhdGhlci5pcjBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABDi4MWZ4yKMdO2IU
XTvTeexD9+4ea4HcJF7UHeW6YEDV4r0PpBrv6fb3FFw8lyJ1xD7MEJvDu4HW/th6
1JSaWYqjggMvMIIDKzAOBgNVHQ8BAf8EBAMCB4AwHQYDVR0lBBYwFAYIKwYBBQUH
AwEGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFKuh9qvJgnO1PX+9
lB/z26xwg/gfMB8GA1UdIwQYMBaAFK5IntyHHUSgb9qi5WB0BHjCnACAMDIGCCsG
AQUFBwEBBCYwJDAiBggrBgEFBQcwAoYWaHR0cDovL2U3LmkubGVuY3Iub3JnLzCC
ASMGA1UdEQSCARowggEWgg4qLmFsbGZhdGhlci5pcoIPKi5icmltbGlza2kuY29t
ghAqLmVkdXktY2hpbmEuY29tghIqLm5vcmRlcmVsYmUuY28udWuCDyoub25kZXNt
aWxpbS5mcoISKi5zYW5hdC1zaGFyaWYuY29tghcqLnpob25neWFuZy10ZWxlY29t
LmNvbYIMKi56enRsY2ouY29tggxhbGxmYXRoZXIuaXKCDWJyaW1saXNraS5jb22C
DmVkdXktY2hpbmEuY29tghBub3JkZXJlbGJlLmNvLnVrgg1vbmRlc21pbGltLmZy
ghBzYW5hdC1zaGFyaWYuY29tghV6aG9uZ3lhbmctdGVsZWNvbS5jb22CCnp6dGxj
ai5jb20wEwYDVR0gBAwwCjAIBgZngQwBAgEwLQYDVR0fBCYwJDAioCCgHoYcaHR0
cDovL2U3LmMubGVuY3Iub3JnLzEyLmNybDCCAQsGCisGAQQB1nkCBAIEgfwEgfkA
9wB+AOMjjfKNoojgquCs8PqQyYXwtr/10qUnsAH8HERYxLboAAABnBiFlNMACAAA
BQAxJuMWBAMARzBFAiAIM1uJyiXB7ouuL4n/YiyGvV50z/U3xZbIUnHFaMlvaAIh
AJ21/teWm+wUiYxtChaxFXMpXhrP3LsU3a13zTXF8gmlAHUAyzj3FYl8hKFEX1vB
3fvJbvKaWc1HCmkFhbDLFMMUWOcAAAGcGIWavwAABAMARjBEAiBIwge87mRo9ftt
c6uPjVnh4V5/JLay1QqvHHKE3b/lqAIgTdsKjLD+UmSSyGgbRQjepunkVNuYUVsC
37lvJXj8XIUwCgYIKoZIzj0EAwMDaAAwZQIwXl1rruNyuyePO7bl0t2cCvOLkfpl
LF31BiAV11UBgFU3XljfiH+a87DhT9Rm5JBDAjEA0lDRhI/KRG7x8RGYDbegoOLE
2Mw06orzZU7G9QNygn/4Cr3HiOlTQUcuHLrzRdet
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEVzCCAj+gAwIBAgIRAKp18eYrjwoiCWbTi7/UuqEwDQYJKoZIhvcNAQELBQAw
TzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5IFJlc2Vh
cmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMjQwMzEzMDAwMDAw
WhcNMjcwMzEyMjM1OTU5WjAyMQswCQYDVQQGEwJVUzEWMBQGA1UEChMNTGV0J3Mg
RW5jcnlwdDELMAkGA1UEAxMCRTcwdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARB6AST
CFh/vjcwDMCgQer+VtqEkz7JANurZxLP+U9TCeioL6sp5Z8VRvRbYk4P1INBmbef
QHJFHCxcSjKmwtvGBWpl/9ra8HW0QDsUaJW2qOJqceJ0ZVFT3hbUHifBM/2jgfgw
gfUwDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcD
ATASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQWBBSuSJ7chx1EoG/aouVgdAR4
wpwAgDAfBgNVHSMEGDAWgBR5tFnme7bl5AFzgAiIyBpY9umbbjAyBggrBgEFBQcB
AQQmMCQwIgYIKwYBBQUHMAKGFmh0dHA6Ly94MS5pLmxlbmNyLm9yZy8wEwYDVR0g
BAwwCjAIBgZngQwBAgEwJwYDVR0fBCAwHjAcoBqgGIYWaHR0cDovL3gxLmMubGVu
Y3Iub3JnLzANBgkqhkiG9w0BAQsFAAOCAgEAjx66fDdLk5ywFn3CzA1w1qfylHUD
aEf0QZpXcJseddJGSfbUUOvbNR9N/QQ16K1lXl4VFyhmGXDT5Kdfcr0RvIIVrNxF
h4lqHtRRCP6RBRstqbZ2zURgqakn/Xip0iaQL0IdfHBZr396FgknniRYFckKORPG
yM3QKnd66gtMst8I5nkRQlAg/Jb+Gc3egIvuGKWboE1G89NTsN9LTDD3PLj0dUMr
OIuqVjLB8pEC6yk9enrlrqjXQgkLEYhXzq7dLafv5Vkig6Gl0nuuqjqfp0Q1bi1o
yVNAlXe6aUXw92CcghC9bNsKEO1+M52YY5+ofIXlS/SEQbvVYYBLZ5yeiglV6t3S
M6H+vTG0aP9YHzLn/KVOHzGQfXDP7qM5tkf+7diZe7o2fw6O7IvN6fsQXEQQj8TJ
UXJxv2/uJhcuy/tSDgXwHM8Uk34WNbRT7zGTGkQRX0gsbjAea/jYAoWv0ZvQRwpq
Pe79D/i7Cep8qWnA+7AE/3B3S/3dEEYmc0lpe1366A/6GEgk3ktr9PEoQrLChs6I
tu3wnNLB2euC8IKGLQFpGtOO/2/hiAKjyajaBP25w1jF0Wl8Bbqne3uZ2q1GyPFJ
YRmT7/OXpmOH/FVLtwS+8ng1cAmpCujPwteJZNcDG0sF2n/sc0+SQf49fdyUK0ty
+VUwFj9tmWxyR/M=
-----END CERTIFICATE-----
EOF

# ایجاد یا بازنویسی فایل key.pem
cat > "$CERTS_DIR/key.pem" << 'EOF'
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIEbtYeIDbUkl+xBcHVnKQ4dJfnJ2m8yR6KWoJ9v5sV1XoAoGCCqGSM49
AwEHoUQDQgAEOLgxZnjIox07YhRdO9N57EP37h5rgdwkXtQd5bpgQNXivQ+kGu/p
9vcUXDyXInXEPswQm8O7gdb+2HrUlJpZig==
-----END EC PRIVATE KEY-----
EOF

# ایمن‌سازی دسترسی‌ها
chmod 600 "$CERTS_DIR/key.pem"
chmod 644 "$CERTS_DIR/fullchain.pem"

echo "All done! Certificates are placed in $CERTS_DIR"
