#!/bin/bash

# مسیر مورد نظر شما
CERTS_DIR="/var/lib/marznode/certs"

# اگر پوشه وجود نداشته باشد، آن را می‌سازد (-p یعنی اگر والد هم نبود بساز)
if [ ! -d "$CERTS_DIR" ]; then
    echo "Directory $CERTS_DIR does not exist. Creating it..."
    mkdir -p "$CERTS_DIR"
fi

echo "Writing certificate files..."

# ایجاد یا بازنویسی فایل fullchain.pem
cat > "$CERTS_DIR/fullchain.pem" << 'EOF'
-----BEGIN CERTIFICATE-----
MIIElDCCBBqgAwIBAgISBsWAQM+zTL0CdYpCdYaL+FWEMAoGCCqGSM49BAMDMDIx
CzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQswCQYDVQQDEwJF
ODAeFw0yNjAyMDcxMjE0MDBaFw0yNjA1MDgxMjEzNTlaMB4xHDAaBgNVBAMTE2Ft
YXpvbi1pcmFuLWZyZWUuaXIwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQTHaOP
xlVr9NRgu6YDSVSadcmkPgNZHa/ApGA3Z5H9AfeMd3zHd4WQHmuQPNnk4tl078fu
gCsxRLS5ko9J8wAbo4IDIjCCAx4wDgYDVR0PAQH/BAQDAgeAMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMB0GA1UdDgQWBBSNyIPr
VMGyR5y6k/K47Nqp5N7c1jAfBgNVHSMEGDAWgBSPDROi9i5+0VBsMxg4XVmOI3KR
yjAyBggrBgEFBQcBAQQmMCQwIgYIKwYBBQUHMAKGFmh0dHA6Ly9lOC5pLmxlbmNy
Lm9yZy8wggEVBgNVHREEggEMMIIBCIIVKi5hbWF6b24taXJhbi1mcmVlLmlyghcq
LmF0YWxtYXRhbC10b290b29sZS5pcoIUKi5lYmF5LWlyYW4tYXJ6YW4uaXKCDiou
bWh1YmItbWNjLmlyggsqLm1pemUzNi5pcoITKi5zZW5pb3JyLWxlYXJubi5pcoIR
Ki50aG9yLW9kaW5zb24uaXKCE2FtYXpvbi1pcmFuLWZyZWUuaXKCFWF0YWxtYXRh
bC10b290b29sZS5pcoISZWJheS1pcmFuLWFyemFuLmlyggxtaHViYi1tY2MuaXKC
CW1pemUzNi5pcoIRc2VuaW9yci1sZWFybm4uaXKCD3Rob3Itb2RpbnNvbi5pcjAT
BgNVHSAEDDAKMAgGBmeBDAECATAsBgNVHR8EJTAjMCGgH6AdhhtodHRwOi8vZTgu
Yy5sZW5jci5vcmcvNS5jcmwwggENBgorBgEEAdZ5AgQCBIH+BIH7APkAdgCWl2S/
VViXrfdDh2g3CEJ36fA61fak8zZuRqQ/D8qpxgAAAZw4O4ULAAAEAwBHMEUCIQCb
5dO+4SktBfg6SKYYiO0A7XDRO1MoTyU8nGddsUybegIgMYkyL/ESArwPA15z+Ry+
NFhteoTQukcw4D4eMpqaoP4AfwAai51pSleYyJmgyoi99I/AtFZgzMNgDR9x9Gn/
x9GsowAAAZw4O4UVAAgAAAUAQ3hIigQDAEgwRgIhAINaFXooyLjE0avY10mlev7r
Ruax35IeVvaE0Qv2jgFjAiEA87QC0u7vb4QpeCoyhLAOoVknxFliUV2gNgObb1U9
lowwCgYIKoZIzj0EAwMDaAAwZQIwLHs99DcOQs0TygC9a2c+zU0Ah3wlf6/VfYFS
csvNDzbuIdB5iOz9WG6/57IpH990AjEAnALt1DGx19/j2UpVmjsV6zzMbNw6lBu5
b1EU92ZWfPj34pPsfHzdcKn2KFZxeNtp
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEVjCCAj6gAwIBAgIQY5WTY8JOcIJxWRi/w9ftVjANBgkqhkiG9w0BAQsFADBP
MQswCQYDVQQGEwJVUzEpMCcGA1UEChMgSW50ZXJuZXQgU2VjdXJpdHkgUmVzZWFy
Y2ggR3JvdXAxFTATBgNVBAMTDElTUkcgUm9vdCBYMTAeFw0yNDAzMTMwMDAwMDBa
Fw0yNzAzMTIyMzU5NTlaMDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBF
bmNyeXB0MQswCQYDVQQDEwJFODB2MBAGByqGSM49AgEGBSuBBAAiA2IABNFl8l7c
S7QMApzSsvru6WyrOq44ofTUOTIzxULUzDMMNMchIJBwXOhiLxxxs0LXeb5GDcHb
R6EToMffgSZjO9SNHfY9gjMy9vQr5/WWOrQTZxh7az6NSNnq3u2ubT6HTKOB+DCB
9TAOBgNVHQ8BAf8EBAMCAYYwHQYDVR0lBBYwFAYIKwYBBQUHAwIGCCsGAQUFBwMB
MBIGA1UdEwEB/wQIMAYBAf8CAQAwHQYDVR0OBBYEFI8NE6L2Ln7RUGwzGDhdWY4j
cpHKMB8GA1UdIwQYMBaAFHm0WeZ7tuXkAXOACIjIGlj26ZtuMDIGCCsGAQUFBwEB
BCYwJDAiBggrBgEFBQcwAoYWaHR0cDovL3gxLmkubGVuY3Iub3JnLzATBgNVHSAE
DDAKMAgGBmeBDAECATAnBgNVHR8EIDAeMBygGqAYhhZodHRwOi8veDEuYy5sZW5j
ci5vcmcvMA0GCSqGSIb3DQEBCwUAA4ICAQBnE0hGINKsCYWi0Xx1ygxD5qihEjZ0
RI3tTZz1wuATH3ZwYPIp97kWEayanD1j0cDhIYzy4CkDo2jB8D5t0a6zZWzlr98d
AQFNh8uKJkIHdLShy+nUyeZxc5bNeMp1Lu0gSzE4McqfmNMvIpeiwWSYO9w82Ob8
otvXcO2JUYi3svHIWRm3+707DUbL51XMcY2iZdlCq4Wa9nbuk3WTU4gr6LY8MzVA
aDQG2+4U3eJ6qUF10bBnR1uuVyDYs9RhrwucRVnfuDj29CMLTsplM5f5wSV5hUpm
Uwp/vV7M4w4aGunt74koX71n4EdagCsL/Yk5+mAQU0+tue0JOfAV/R6t1k+Xk9s2
HMQFeoxppfzAVC04FdG9M+AC2JWxmFSt6BCuh3CEey3fE52Qrj9YM75rtvIjsm/1
Hl+u//Wqxnu1ZQ4jpa+VpuZiGOlWrqSP9eogdOhCGisnyewWJwRQOqK16wiGyZeR
xs/Bekw65vwSIaVkBruPiTfMOo0Zh4gVa8/qJgMbJbyrwwG97z/PRgmLKCDl8z3d
tA0Z7qq7fta0Gl24uyuB05dqI5J1LvAzKuWdIjT1tP8qCoxSE/xpix8hX2dt3h+/
jujUgFPFZ0EVZ0xSyBNRF3MboGZnYXFUxpNjTWPKpagDHJQmqrAcDmWJnMsFY3jS
u1igv3OefnWjSQ==
-----END CERTIFICATE-----


EOF

# ایجاد یا بازنویسی فایل key.pem
cat > "$CERTS_DIR/key.pem" << 'EOF'
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIHd3METSGVJ9jBosdePENcIqM3PPFBiTgRmR1ciZYq7goAoGCCqGSM49
AwEHoUQDQgAEEx2jj8ZVa/TUYLumA0lUmnXJpD4DWR2vwKRgN2eR/QH3jHd8x3eF
kB5rkDzZ5OLZdO/H7oArMUS0uZKPSfMAGw==
-----END EC PRIVATE KEY-----

EOF

# ایمن‌سازی دسترسی‌ها
chmod 600 "$CERTS_DIR/key.pem"
chmod 644 "$CERTS_DIR/fullchain.pem"

echo "All done! Certificates are placed in $CERTS_DIR"
